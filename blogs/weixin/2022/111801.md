---
title: 微信小程序学习
date: '2022-11-18 10:26:57'
tags: 
  - 微信小程序
---

## 动态绑定属性
```js
// wxml
<image src="{{ imgSrc }}" mode="widthFix"></image>

// js
data: {
  imgSrc: 'http://www.itcast.cn/2018czgw/images/logo.png'
}
```

## 常用事件
* bindtap、bindinput、bindchange
* bind:tap、bind:input、bind:chage

|  类型  |         绑定方式          |                    事件描述                     |
| :----: | :-----------------------: | :---------------------------------------------: |
|  tap   |    bindtap 或 bind:tap    | 手指触摸后马上离开，类似于 HTML 中的 click 事件 |
| input  | bindinput 或者 bind:input |                文本框的输入事件                 |
| change | bindchange 或 bind:change |                 状态改变时触发                  |

### bindtap语法
```js
// wxml
<button type="primary" bindtap="bindTapHandler">按钮</button>

// js
Page({
  bindTapHandler(e:any){
    console.log(e);
  }
})
```
* 小程序中的事件传参比较特殊，不能在绑定事件的同时为事件处理程序传递参数
```js
// wxml
// 该代码不生效
<button type="primary" bindtap="bindTapHandler(123)">按钮</button>

// 传参的正确方式
// wxml
<button type="primary" bindtap="bindTapHandler" data-myInfo="{{ {age:'18',name:'luochao'}  }}">按钮</button>
// js
Page({
  bindTapHandler(e:any){
    console.log(e.target.dataset) // dataset是一个对象，包含了所有data-* 传递过来的参数项
    console.log(e.target.dataset.myInfo); // {age:'18',name:'luochao'}
  }
})
```
* 在事件处理函数中为 data 中的数据赋值
通过调用 this.setData(dataObject) 方法，可以给页面 data 中的数据重新赋值
```js
Page({
  data:{
    textMyObj:{
      number:999
    }
  },
  bindTapHandler(e:any){
    this.setData({
      textMyObj:{
        number:888
      }
    })
  },
})
```
### bindinput语法
```js
// wxml
<input bindinput="inputHandler"></input>

// js
Page({
  inputHandler(e:any){
    // e.detail.value 是输入框最新输入的值
    console.log(e.detail.value)
  }
})
```
* input输入框的数据绑定
```js
// wxml
<input value="{{count}}" bindinput="inputHandler"></input>

// js
Page({
  data:{
    count:1,
  },
  inputHandler(e:any){
    this.setData({
      count:e.detail.value
    })
  },
})
```

## 条件渲染
```js
// 相当于v-if
<view wx:if="{{ type === 1 }}">男</view>
<view wx:elif="{{ type === 2 }}">女</view>
<view wx:else>保密</view>

<block wx:if="{{ true }}"> // 相当于template标签
  <view>亚瑟</view>
  <view>妲己</view>
  <view>蒙恬</view>
</block>

// 相当于v-show,切换样式display:none/block，控制元素显隐
<view hidden="{{ false }}">条件为 true 隐藏，条件为 false 显示</view>
```

## 列表渲染
### 常规
```js
// wxml
// 默认数组的当前项的下标变量名默认为 index，数组当前项的变量名默认为 item
<view wx:for="{{ arr }}">
  索引是: {{ index }}，数组的每一项是：{{ item }}
</view>

// js
Page({
  data:{
    arr:['亚瑟', '妲己', '蒙恬']
  },
})
```
### 手动指定索引和当前项的变量名
```js
// wxml
// 使用 wx:for-item 可以指定数组当前元素的变量名
// 使用 wx:for-index 可以指定数组当前下表的变量名
// 使用 wx:key 可以列表项指定唯一的 key 值
<view wx:for="{{ arr }}" wx:for-index="idx" wx:for-item="itemName" wx:key="id">
  索引是: {{ idx }}，数组的每一项是：{{ itemName }}
</view>

// js
Page({
  data:{
    arr:[
      {id:1,name:'小红'},
      {id:2,name:'小黄'},
      {id:3,name:'小白'},
    ]
  },
})
```

## wxss
与css相比，wxss扩展的特性有
* rpx
是微信小程序独有的用来解决屏幕适配的尺寸单位
实现原理：rpx把所有大小的屏幕等分为750份，每一份就是1rpx
以iphone6为例，iphone6屏幕为375px，1rpx=0.5px

* @import引入样式表
![](https://s3.uuu.ovh/imgs/2022/11/18/9d771ebebb378e83.png)

## 数据请求
### 限制
* 只能请求https类型的接口
* 必须将接口的域名添加到信任列表中
配置步骤：登录微信小程序管理后台 --> 开发 --> 开发管理 --> 开发设置 --> 服务器域名 --> 修改 request 合法域名

### 发起请求
```js
wx.request({
  url: 'example.php', //仅为示例，并非真实的接口地址
  method:'GET',
  data: {
    x: '',
    y: ''
  },
  success (res) {
    console.log(res.data)
  },
  fail () {
    console.log('fail')
  },
  complete () {
    console.log('complete')
  },
})
```